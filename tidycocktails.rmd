---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(tidytuesdayR)
```

```{r}
tuesdata <- tidytuesdayR::tt_load(2020, week = 22)

cocktails_raw <- tuesdata$cocktails
```

```{r}
# cleaning glass

cocktails_v1 <- 
  cocktails_raw %>%
  mutate(glass = str_to_lower(glass),
         glass = str_replace_all(glass, " ", "_"),
         # looks like there is a margarita/coupette and margarita
         glass = str_replace(glass, "margarita/coupette_glass", "margarita_glass")) %>%
  select(-date_modified, -drink_thumb, -iba, -video)

# cleaning alcoholic

cocktails_v2 <-
  cocktails_v1 %>% 
  mutate(alcoholic = str_to_lower(alcoholic),
         alcoholic = str_replace_all(alcoholic, " ", "_"),
         # just changed the NA's to unknown to keep data full
         alcoholic = replace_na(alcoholic, "unknown"))

# cleaning ingredient

# had 333 different ingredients before
# had 306 after, so we cleaned up some discrepancy which is good
cocktails_v3 <-
  cocktails_v2 %>%
  mutate(ingredient = str_to_lower(ingredient),
         ingredient = str_replace_all(ingredient, " ", "_")) 

# cleaning measure

# id like an `amount` and `unit` column, but it is veryyyy messy
# it looks like we need 3 columns total, the two aforementioned and a either `TRUE` to indicate original
# ingredient, or if its another ingredient
# you can highlight text and press " and it puts it in quotes!

cocktails_v3 %>%
  filter(str_detect(measure, " oz")) %>%  # I have a space here to avoid things like fr`oz`en
  count(measure, sort = T) %>%
  mutate(measure = str_replace(measure, "/", " sl "),
         measure = str_to_lower(measure),
         measure = str_replace(measure, "70ml sl 2fl oz", "2 oz")) %>%
  extract(
    measure,
    into = c("amount", "unit", "extra"),
    regex = "([0-9]\\.?-?[0-9]?[0-9]?\\s?[0-9]?\\s?s?l?\\s?[1-9]?\\s?[1-9]?[0-9]?)(oz)(\\s[a-z].*)?"
    ) %>%
  mutate(amount = str_replace(amount, " sl ", "/")) %>% 
  View()

 
# function for fraction fixing

                                       
```

