---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(tidytuesdayR)
```

```{r}
tuesdata <- tidytuesdayR::tt_load(2020, week = 22)

cocktails_raw <- tuesdata$cocktails
```

```{r}
# cleaning glass

cocktails_v1 <- 
  cocktails_raw %>%
  mutate(glass = str_to_lower(glass),
         glass = str_replace_all(glass, " ", "_"),
         # looks like there is a margarita/coupette and margarita
         glass = str_replace(glass, "margarita/coupette_glass", "margarita_glass")) %>%
  select(-date_modified, -drink_thumb, -iba, -video)

# cleaning alcoholic

cocktails_v2 <-
  cocktails_v1 %>% 
  mutate(alcoholic = str_to_lower(alcoholic),
         alcoholic = str_replace_all(alcoholic, " ", "_"),
         # just changed the NA's to unknown to keep data full
         alcoholic = replace_na(alcoholic, "unknown"))

# cleaning ingredient

# had 333 different ingredients before
# had 306 after, so we cleaned up some discrepancy which is good
cocktails_v3 <-
  cocktails_v2 %>%
  mutate(ingredient = str_to_lower(ingredient),
         ingredient = str_replace_all(ingredient, " ", "_")) 

# cleaning measure

# id like an `amount` and `unit` column, but it is veryyyy messy
# it looks like we need 3 columns total, the two aforementioned and a either `TRUE` to indicate original
# ingredient, or if its another ingredient
# you can highlight text and press " and it puts it in quotes!

cocktails_v3 %>%
  filter(str_detect(measure, " oz")) %>%  # I have a space here to avoid things like fr`oz`en
  count(measure, sort = T) %>% 
  # separating by oz here works because we filtered earlier to only include observations with oz
  separate(measure, into = c("num", "unit", "extra"), sep = "oz", remove = F) %>%  
  separate(num, into = c("first", "second"), sep = " ") %>%
  mutate(first = str_replace(first, "^70", "2"),
         first = str_replace(first, "add", "0"),
         first = str_replace())
  mutate(second = sapply(second, function(x) eval(parse(text = as.character(x)))),
         second = str_replace(second, "NULL", "0"),
         first = sapply(first, function(x) eval(parse(text = as.character(x))))) %>% 
  #mutate(num = str_replace(num, " ", "+"),
  #       num = str_remove(num, "\\+$")) %>% 
  View()

`# command right arrow takes you to end of line

                                       
```

